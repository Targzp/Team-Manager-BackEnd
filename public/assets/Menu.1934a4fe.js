var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,m=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,r=(e,l)=>{for(var a in l||(l={}))o.call(l,a)&&m(e,a,l[a]);if(t)for(var a of t(l))n.call(l,a)&&m(e,a,l[a]);return e};import{r as u,O as d,o as i,c as s,d as p,e as c,w as h,P as f,F as b,a as y,b as F,g as _,Q as w,f as g}from"./vendor.b1d65a4d.js";const V={name:"menu",data:()=>({queryForm:{menuState:1},menuList:[],allMenuList:[],menuForm:{parentId:[null],menuType:1,menuState:1},showModel:!1,addType:1,action:"",columns:[{label:"菜单名称",prop:"menuName",width:150,align:"center"},{label:"图标",prop:"icon",width:180},{label:"菜单类型",prop:"menuType",formatter:(e,l,a)=>({1:"菜单",2:"按钮"}[a])},{label:"权限标识",prop:"menuCode"},{label:"路由地址",prop:"path"},{label:"组件路径",prop:"component"},{label:"菜单状态",prop:"menuState",formatter:(e,l,a)=>({1:"正常",2:"停用"}[a])}],rules:{menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:10,message:"长度在2-8个字符",trigger:"blur"}]}}),mounted(){this.getMenuList()},methods:{async getMenuList(){try{let e=r({},this.queryForm),l=null,a=null;(e.menuName||e.menuState)&&(l=await this.$api.getMenuList(e)),a=await this.$api.getMenuList({menuState:1}),this.allMenuList=a,this.menuList=l||a}catch(e){throw new Error(e)}},handleQuery(){this.getMenuList()},handleReset(e){this.$refs[e].resetFields(),this.addType=1},handleAdd(e,l){this.showModel=!0,this.action="add",2===e&&(this.menuForm.parentId=[...l.parentId,l._id].filter((e=>e)))},handleEdit(e){this.showModel=!0,this.action="edit",this.$nextTick((()=>{this.menuForm=r({},e)}))},async handleDelete(e){const l=e._id;try{await this.$api.menuSubmit({_id:l,action:"delete"}),this.$message.success("删除成功"),this.getMenuList()}catch(a){throw new Error(a)}},handleClose(){this.showModel=!1,this.handleReset("dialogForm")},handleSubmit(){this.$refs.dialogForm.validate((async e=>{if(e){let e=this.action,n=(t=r({},this.menuForm),l(t,a({action:e})));try{await this.$api.menuSubmit(n);this.showModel=!1,this.$message.success("操作成功"),this.handleReset("dialogForm"),this.getMenuList()}catch(o){throw new Error(o)}}var t}))}}},k={class:"menu-manager"},C={class:"query-form"},v=g("查询"),S=g("重置"),M={class:"base-table"},T={class:"action"},L=g("创建"),U=g("新增"),N=g("编辑"),O=g("删除"),q={key:0,class:"tip"},$=g("菜单"),j=g("按钮"),I=g("正常"),E=g("停用"),P={class:"dialog-footer"},x=g("取 消"),R=g("确 定");V.render=function(e,l,a,t,o,n){const m=u("el-input"),r=u("el-form-item"),g=u("el-option"),V=u("el-select"),z=u("el-button"),A=u("el-form"),D=u("el-table-column"),Q=u("el-table"),B=u("el-cascader"),G=u("el-radio"),H=u("el-radio-group"),J=u("el-dialog"),K=d("has");return i(),s("div",k,[p("div",C,[c(A,{inline:!0,model:o.queryForm,ref:"validateForm"},{default:h((()=>[c(r,{label:"菜单名称",prop:"menuName"},{default:h((()=>[c(m,{modelValue:o.queryForm.menuName,"onUpdate:modelValue":l[0]||(l[0]=e=>o.queryForm.menuName=e),placeholder:"请输入菜单名称"},null,8,["modelValue"])])),_:1}),c(r,{label:"菜单状态",prop:"menuState"},{default:h((()=>[c(V,{modelValue:o.queryForm.menuState,"onUpdate:modelValue":l[1]||(l[1]=e=>o.queryForm.menuState=e),label:"菜单状态",prop:"menuState"},{default:h((()=>[c(g,{value:1,label:"正常"}),c(g,{value:2,label:"停用"})])),_:1},8,["modelValue"])])),_:1}),c(r,null,{default:h((()=>[c(z,{type:"primary",onClick:n.handleQuery},{default:h((()=>[v])),_:1},8,["onClick"]),c(z,{onClick:l[2]||(l[2]=()=>n.handleReset("validateForm"))},{default:h((()=>[S])),_:1})])),_:1})])),_:1},8,["model"])]),p("div",M,[p("div",T,[f(c(z,{type:"primary",onClick:l[3]||(l[3]=()=>n.handleAdd(o.addType))},{default:h((()=>[L])),_:1},512),[[K,"menu-create"]])]),c(Q,{"max-height":"350",data:o.menuList,"row-key":"_id","tree-props":{children:"children"}},{default:h((()=>[(i(!0),s(b,null,y(o.columns,(e=>(i(),F(D,{key:e.prop,prop:e.prop,label:e.label,width:e.width,align:e.align,formatter:e.formatter},null,8,["prop","label","width","align","formatter"])))),128)),c(D,{label:"操作",width:"250",align:"center"},{default:h((e=>[1===e.row.menuType?f((i(),F(z,{key:0,size:"mini",type:"primary",onClick:l=>n.handleAdd(o.addType=2,e.row)},{default:h((()=>[U])),_:2},1032,["onClick"])),[[K,"menu-create"]]):_("v-if",!0),f(c(z,{size:"mini",plain:"",onClick:l=>n.handleEdit(e.row)},{default:h((()=>[N])),_:2},1032,["onClick"]),[[K,"menu-edit"]]),f(c(z,{type:"danger",size:"mini",onClick:l=>n.handleDelete(e.row)},{default:h((()=>[O])),_:2},1032,["onClick"]),[[K,"menu-delete"]])])),_:1})])),_:1},8,["data"])]),c(J,{title:"edit"==o.action?"菜单编辑":"菜单新增",modelValue:o.showModel,"onUpdate:modelValue":l[12]||(l[12]=e=>o.showModel=e),"close-on-click-modal":!1,"show-close":!1,"close-on-press-escape":!1,center:!0},{footer:h((()=>[p("span",P,[c(z,{onClick:n.handleClose},{default:h((()=>[x])),_:1},8,["onClick"]),c(z,{type:"primary",onClick:n.handleSubmit},{default:h((()=>[R])),_:1},8,["onClick"])])])),default:h((()=>[c(A,{ref:"dialogForm",model:o.menuForm,"label-width":"100px",rules:o.rules},{default:h((()=>[c(r,{label:"父级菜单",prop:"parentId"},{default:h((()=>[c(B,{modelValue:o.menuForm.parentId,"onUpdate:modelValue":l[4]||(l[4]=e=>o.menuForm.parentId=e),placeholder:"请选择父级菜单",disabled:2===o.addType,options:o.allMenuList,props:{checkStrictly:!0,value:"_id",label:"menuName"},clearable:""},null,8,["modelValue","disabled","options"]),2!==o.addType?(i(),s("span",q,"不选，则直接创建一级菜单")):_("v-if",!0)])),_:1}),c(r,{label:"菜单类型",prop:"menuType"},{default:h((()=>[c(H,{modelValue:o.menuForm.menuType,"onUpdate:modelValue":l[5]||(l[5]=e=>o.menuForm.menuType=e)},{default:h((()=>[c(G,{label:1},{default:h((()=>[$])),_:1}),c(G,{label:2},{default:h((()=>[j])),_:1})])),_:1},8,["modelValue"])])),_:1}),c(r,{label:"菜单名称",prop:"menuName"},{default:h((()=>[c(m,{modelValue:o.menuForm.menuName,"onUpdate:modelValue":l[6]||(l[6]=e=>o.menuForm.menuName=e),placeholder:"请输入菜单名称"},null,8,["modelValue"])])),_:1}),f(c(r,{label:"菜单图标",prop:"icon"},{default:h((()=>[c(m,{modelValue:o.menuForm.icon,"onUpdate:modelValue":l[7]||(l[7]=e=>o.menuForm.icon=e),placeholder:"请输入菜单图标"},null,8,["modelValue"])])),_:1},512),[[w,1===o.menuForm.menuType]]),f(c(r,{label:"路由地址",prop:"path"},{default:h((()=>[c(m,{modelValue:o.menuForm.path,"onUpdate:modelValue":l[8]||(l[8]=e=>o.menuForm.path=e),placeholder:"请输入路由地址"},null,8,["modelValue"])])),_:1},512),[[w,1===o.menuForm.menuType]]),c(r,{label:"权限标识",prop:"menuCode"},{default:h((()=>[c(m,{modelValue:o.menuForm.menuCode,"onUpdate:modelValue":l[9]||(l[9]=e=>o.menuForm.menuCode=e),placeholder:"请输入权限标识"},null,8,["modelValue"])])),_:1}),f(c(r,{label:"组件路径",prop:"component"},{default:h((()=>[c(m,{modelValue:o.menuForm.component,"onUpdate:modelValue":l[10]||(l[10]=e=>o.menuForm.component=e),placeholder:"请输入组件路径"},null,8,["modelValue"])])),_:1},512),[[w,1===o.menuForm.menuType]]),f(c(r,{label:"菜单状态",prop:"menuState"},{default:h((()=>[c(H,{modelValue:o.menuForm.menuState,"onUpdate:modelValue":l[11]||(l[11]=e=>o.menuForm.menuState=e)},{default:h((()=>[c(G,{label:1},{default:h((()=>[I])),_:1}),c(G,{label:2},{default:h((()=>[E])),_:1})])),_:1},8,["modelValue"])])),_:1},512),[[w,1===o.menuForm.menuType]])])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])};export{V as default};
