var e=Object.defineProperty,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,a=(t,o,s)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s;import{r as n,o as r,c as i,a as l,F as u,b as m,w as c,d,n as p,t as g,e as h,f as _,g as v,T as f,h as L,E as b,_ as k,i as I,j as w,k as y,l as E,m as P}from"./vendor.b1d65a4d.js";let A;const R={},C=function(e,t){if(!t||0===t.length)return e();if(void 0===A){const e=document.createElement("link").relList;A=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if((e=`/${e}`)in R)return;R[e]=!0;const t=e.endsWith(".css"),o=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${o}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":A,t||(s.as="script",s.crossOrigin=""),s.href=e,document.head.appendChild(s),t?new Promise(((e,t)=>{s.addEventListener("load",e),s.addEventListener("error",t)})):void 0}))).then((()=>e()))},M={name:"TreeMenu",props:{userMenu:{type:Array,default:()=>[]}}};M.render=function(e,t,o,s,a,f){const L=n("tree-menu",!0),b=n("el-submenu"),k=n("el-menu-item");return r(!0),i(u,null,l(o.userMenu,(e=>(r(),i(u,{key:e._id},[e.children&&e.children.length>0&&1==e.children[0].menuType?(r(),m(b,{key:0,index:e.path},{title:c((()=>[d("i",{class:p(e.icon)},null,2),d("span",null,g(e.menuName),1)])),default:c((()=>[h(L,{userMenu:e.children},null,8,["userMenu"])])),_:2},1032,["index"])):1==e.menuType?(r(),m(k,{key:1,index:e.path},{default:c((()=>[_(g(e.menuName),1)])),_:2},1032,["index"])):v("v-if",!0)],64)))),128)};const O={name:"BreadCrumb",computed:{breadList(){return this.$route.matched}}},$={key:1};O.render=function(e,t,o,s,a,d){const p=n("router-link"),h=n("el-breadcrumb-item"),v=n("el-breadcrumb");return r(),m(v,{"separator-class":"el-icon-arrow-right"},{default:c((()=>[(r(!0),i(u,null,l(d.breadList,((e,t)=>(r(),m(h,{key:e.path},{default:c((()=>[0===t?(r(),m(p,{key:0,to:"/welcome"},{default:c((()=>[_(g(e.meta.title),1)])),_:2},1024)):(r(),i("span",$,g(e.meta.title),1))])),_:2},1024)))),128))])),_:1})};const T={name:"Home",components:{TreeMenu:M,BreadCrumb:O},data(){return{isCollapse:!1,userInfo:this.$store.state.userInfo,userMenu:[],activeMenu:location.hash.slice(1)}},computed:{noticeCount(){return this.$store.state.noticeCount}},mounted(){this.getNoticeCount(),this.getMenuList()},methods:{toggle(){this.isCollapse=!this.isCollapse},handleLogOut(e){"email"!==e&&(this.$store.commit("saveUserInfo",""),this.userInfo={},this.$router.addRoute({name:"Home",path:"/",meta:{title:"首页"},component:()=>C((()=>Promise.resolve().then((function(){return q}))),void 0),redirect:{name:"Welcome"},children:[{name:"Welcome",path:"welcome",meta:{title:"欢迎使用"},component:()=>C((()=>import("./Welcome.eb10983e.js")),["assets/Welcome.eb10983e.js","assets/Welcome.d4a07ff2.css","assets/vendor.b1d65a4d.js"])}]}),this.$router.push("/login"))},handleNotice(){this.$store.state.noticeCount>0&&(this.activeMenu="/audit/approve",this.$router.push("/audit/approve"))},async getNoticeCount(){try{const e=await this.$api.noticeCount();this.$store.commit("changeNoticeCount",e)}catch(e){console.log(e)}},async getMenuList(){try{const{menuList:e,actionList:t}=await this.$api.getPermissionList();this.userMenu=e,this.$store.commit("saveUserMenuList",e),this.$store.commit("saveUserActionList",t)}catch(e){console.log(e)}}}},j={class:"basic-layout"},S=d("div",{class:"logo"},[d("img",{src:"/assets/logo.05c9b4dd.png",alt:""}),d("span",null,"Manager")],-1),D={class:"nav-top"},N={class:"nav-left"},V=[d("i",{class:"el-icon-s-fold"},null,-1)],U={class:"bread"},x={class:"user-info"},W=d("i",{class:"el-icon-bell"},null,-1),z={class:"user-link"},F=_("退出"),H={class:"wrapper"};T.render=function(e,t,o,s,a,l){const u=n("tree-menu"),b=n("el-menu"),k=n("bread-crumb"),I=n("el-badge"),w=n("el-dropdown-item"),y=n("el-dropdown-menu"),E=n("el-dropdown"),P=n("router-view");return r(),i("div",j,[d("div",{class:p(["nav-side",a.isCollapse?"fold":"unfold"])},[v(" 系统 logo "),S,v(" 导航菜单 "),h(b,{"background-color":"#001529","text-color":"#FFF",collapse:a.isCollapse,router:"","default-active":a.activeMenu,class:"nav-menu"},{default:c((()=>[h(u,{userMenu:a.userMenu},null,8,["userMenu"])])),_:1},8,["collapse","default-active"])],2),d("div",{class:p(["content-right",a.isCollapse?"fold":"unfold"])},[d("div",D,[d("div",N,[d("div",{class:"menu-fold",onClick:t[0]||(t[0]=(...e)=>l.toggle&&l.toggle(...e))},V),d("div",U,[h(k)])]),d("div",x,[h(I,{"is-dot":!!l.noticeCount,class:"notice",type:"danger",onClick:l.handleNotice},{default:c((()=>[W])),_:1},8,["is-dot","onClick"]),h(E,{onCommand:l.handleLogOut},{dropdown:c((()=>[h(y,null,{default:c((()=>[h(w,{cpmmand:"email"},{default:c((()=>[_(g(a.userInfo.userEmail),1)])),_:1}),h(w,{command:"logout"},{default:c((()=>[F])),_:1})])),_:1})])),default:c((()=>[d("span",z,g(a.userInfo.userName),1)])),_:1},8,["onCommand"])])]),d("div",H,[v(' <transition name="main" appear>\r\n          <router-view></router-view>\r\n        </transition> '),h(P,null,{default:c((({Component:e})=>[h(f,{name:"main",mode:"out-in"},{default:c((()=>[(r(),m(L(e)))])),_:2},1024)])),_:1})])],2)])};var q=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:T});var B=((e,n)=>{for(var r in n||(n={}))o.call(n,r)&&a(e,r,n[r]);if(t)for(var r of t(n))s.call(n,r)&&a(e,r,n[r]);return e})({env:"prod",mock:!1,namespace:"manager"},{baseApi:"/api",mockApi:""}),J={setItem(e,t){let o=this.getStorage();o[e]=t,window.localStorage.setItem(B.namespace,JSON.stringify(o))},getStorage:()=>JSON.parse(window.localStorage.getItem(B.namespace)||"{}"),getItem(e){return this.getStorage()[e]},clearItem(e){let t=this.getStorage();delete t[e],window.localStorage.setItem(B.namespace,JSON.stringify(t))},clearAll(){window.localStorage.clear()}};const Y=b.create({baseURL:B.baseApi,timeout:8e3});function G(e){return e.method=e.method||"get","get"===e.method.toLowerCase()&&(e.params=e.data),void 0!==e.mock&&(B.mock=e.mock),"prod"===B.env?Y.defaults.baseURL=B.baseApi:Y.defaults.baseURL=B.mock?B.mockApi:B.baseApi,Y(e)}Y.interceptors.request.use((e=>{var t;const o=e.headers,s=(null==(t=null==J?void 0:J.getItem("userInfo"))?void 0:t.token)||"";return o.Authorization||(o.Authorization="Bearer "+s),e})),Y.interceptors.response.use((e=>{const{code:t,data:o,msg:s}=e.data;return 200===t?o:50001===t?(k.error("Token认证失败，请重新登录"),setTimeout((()=>{te.push("/login")}),1500),Promise.reject("Token认证失败，请重新登录")):(k.error(s||"网络请求异常，请稍后重试"),Promise.reject(s||"网络请求异常，请稍后重试"))}));var K={login:e=>G({method:"post",url:"/users/login",data:e,mock:!1}),noticeCount:()=>G({method:"get",url:"/leave/count",data:{},mock:!1}),getMenuList:e=>G({method:"get",url:"/menu/list",data:e,mock:!1}),getUserList:e=>G({method:"get",url:"/users/list",data:e,mock:!1}),getAllUserList:()=>G({method:"get",url:"/users/all/list",data:{},mock:!1}),getPermissionList:()=>G({method:"get",url:"/users/getPermissionList",data:{},mock:!1}),userDel:e=>G({method:"post",url:"/users/delete",data:e,mock:!1}),getRoleNameList:()=>G({method:"get",url:"/roles/allList",data:{},mock:!1}),getRoleList:e=>G({method:"get",url:"/roles/list",data:e,mock:!1}),getDeptList:e=>G({method:"get",url:"/dept/list",data:e,mock:!1}),userSubmit:e=>G({method:"post",url:"/users/operate",data:e,mock:!1}),menuSubmit:e=>G({method:"post",url:"/menu/operate",data:e,mock:!1}),roleSubmit:e=>G({method:"post",url:"/roles/operate",data:e,mock:!1}),updatePermission:e=>G({method:"post",url:"/roles/update/permission",data:e,mock:!1}),deptSubmit:e=>G({method:"post",url:"/dept/operate",data:e,mock:!1}),getApplyList:e=>G({method:"get",url:"/leave/list",data:e,mock:!1}),applySubmit:e=>G({method:"post",url:"/leave/operate",data:e,mock:!1}),approveSubmit:e=>G({method:"post",url:"/leave/approve",data:e,mock:!1})},Q={formateDate(e,t){let o=t||"yyyy-MM-dd hh:mm:ss";/(y+)/.test(o)&&(o=o.replace(RegExp.$1,e.getFullYear()));const s={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(let a in s)if(new RegExp(`(${a})`).test(o)){const e=s[a]+"";o=o.replace(RegExp.$1,1==RegExp.$1.length?e:("00"+e).substr(e.length))}return o},generateRoute(e){let t=[];const o=e=>{e.map((e=>{e.action&&t.push({name:e.component,path:e.path,meta:{title:e.menuName},component:e.component}),e.children&&!e.action&&o(e.children)}))};return o(e),t}};const X={"../views/404.vue":()=>C((()=>import("./404.8f7787af.js")),["assets/404.8f7787af.js","assets/404.e12853c1.css","assets/vendor.b1d65a4d.js","assets/Button.e5f3fabf.js"]),"../views/Approve.vue":()=>C((()=>import("./Approve.d3ab931a.js")),["assets/Approve.d3ab931a.js","assets/Approve.1989dda8.css","assets/vendor.b1d65a4d.js","assets/zh-cn.a582dec9.js"]),"../views/Dept.vue":()=>C((()=>import("./Dept.d6b38560.js")),["assets/Dept.d6b38560.js","assets/vendor.b1d65a4d.js"]),"../views/Leave.vue":()=>C((()=>import("./Leave.9ca985e9.js")),["assets/Leave.9ca985e9.js","assets/Approve.1989dda8.css","assets/vendor.b1d65a4d.js","assets/zh-cn.a582dec9.js"]),"../views/Login.vue":()=>C((()=>import("./Login.6cccd179.js")),["assets/Login.6cccd179.js","assets/Login.e883c6ba.css","assets/vendor.b1d65a4d.js","assets/Button.e5f3fabf.js"]),"../views/Menu.vue":()=>C((()=>import("./Menu.1934a4fe.js")),["assets/Menu.1934a4fe.js","assets/Menu.0c2d3fb5.css","assets/vendor.b1d65a4d.js"]),"../views/Role.vue":()=>C((()=>import("./Role.43455130.js")),["assets/Role.43455130.js","assets/vendor.b1d65a4d.js"]),"../views/User.vue":()=>C((()=>import("./User.a4db6a7f.js")),["assets/User.a4db6a7f.js","assets/vendor.b1d65a4d.js"]),"../views/Welcome.vue":()=>C((()=>import("./Welcome.eb10983e.js")),["assets/Welcome.eb10983e.js","assets/Welcome.d4a07ff2.css","assets/vendor.b1d65a4d.js"])},Z=[{name:"Home",path:"/",meta:{title:"首页"},component:T,redirect:{name:"Welcome"},children:[{name:"Welcome",path:"welcome",meta:{title:"欢迎使用"},component:()=>C((()=>import("./Welcome.eb10983e.js")),["assets/Welcome.eb10983e.js","assets/Welcome.d4a07ff2.css","assets/vendor.b1d65a4d.js"])}]},{name:"Login",path:"/login",meta:{title:"登录"},component:()=>C((()=>import("./Login.6cccd179.js")),["assets/Login.6cccd179.js","assets/Login.e883c6ba.css","assets/vendor.b1d65a4d.js","assets/Button.e5f3fabf.js"])},{name:"404",path:"/404",meta:{title:"页面不存在"},component:()=>C((()=>import("./404.8f7787af.js")),["assets/404.8f7787af.js","assets/404.e12853c1.css","assets/vendor.b1d65a4d.js","assets/Button.e5f3fabf.js"])}],ee=I({history:w(),routes:Z});(async()=>{await async function(){if((J.getItem("userInfo")||{}).token)try{const{menuList:e}=await K.getPermissionList();Q.generateRoute(e).map((e=>{let t=`../views/${e.component}.vue`;e.component=X[t],ee.addRoute("Home",e)}))}catch(e){console.log(e)}}()})(),ee.beforeEach(((e,t,o)=>{ee.hasRoute(e.name)?(document.title=e.meta.title,o()):o("/404")}));var te=ee,oe={saveUserInfo(e,t){e.userInfo=t,J.setItem("userInfo",t)},saveUserMenuList(e,t){e.menuList=t,J.setItem("menuList",t)},saveUserActionList(e,t){e.actionList=t,J.setItem("actionList",t)},changeNoticeCount(e,t){e.noticeCount+=t}};var se=y({state:{userInfo:J.getItem("userInfo")||{},menuList:J.getItem("menuList")||[],actionList:J.getItem("actionList")||[],noticeCount:0},mutations:oe});const ae={};ae.render=function(e,t){const o=n("router-view");return r(),m(o)};const ne=E(ae);ne.config.globalProperties.$request=G,ne.config.globalProperties.$storage=J,ne.config.globalProperties.$utils=Q,ne.config.globalProperties.$api=K,ne.directive("has",{beforeMount:(e,t)=>{let o=J.getItem("actionList"),s=t.value;o.includes(s)||(e.style.display="none",setTimeout((()=>{e.parentNode.removeChild(e)}),0))}}),ne.use(te).use(se).use(P,{size:"small",zIndex:3e3}).mount("#app");export{C as _,K as a,Q as u};
